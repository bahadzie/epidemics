<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="epidemics">
<title>Modelling ebolavirus disease with a stochastic model • epidemics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modelling ebolavirus disease with a stochastic model">
<meta property="og:description" content="epidemics">
<meta property="og:image" content="https://epiverse.github.io/epidemics/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">epidemics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/epidemics.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Package vignettes</h6>
    <a class="dropdown-item" href="../articles/modelling_vaccination.html">Modelling a vaccination campaign</a>
    <a class="dropdown-item" href="../articles/modelling_interventions.html">Modelling interventions</a>
    <a class="dropdown-item" href="../articles/multiple_interventions.html">Modelling multiple overlapping non-pharmaceutical interventions</a>
    <a class="dropdown-item" href="../articles/rate_interventions.html">Modelling interventions on model rates</a>
    <a class="dropdown-item" href="../articles/time_dependence.html">Modelling time-dependence in epidemic parameters</a>
    <a class="dropdown-item" href="../articles/parameter_uncertainty.html">Generating and modelling R uncertainty</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Guides to library models</h6>
    <a class="dropdown-item" href="../articles/vacamole.html">Using the RIVM Vacamole model of leaky vaccination and hospitalisations</a>
    <a class="dropdown-item" href="../articles/ebola_model.html">Modelling ebolavirus disease with a stochastic model</a>
    <a class="dropdown-item" href="../articles/benchmarking.html">Benchmarking R and Rcpp implementations of epidemic models</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/epidemics/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Modelling ebolavirus disease with a stochastic model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/epidemics/blob/HEAD/vignettes/ebola_model.Rmd" class="external-link"><code>vignettes/ebola_model.Rmd</code></a></small>
      <div class="d-none name"><code>ebola_model.Rmd</code></div>
    </div>

    
    
<div class="alert alert-warning">
<p><strong>New to <em>epidemics</em>?</strong> It may help to read the <a href="epidemics.html">“Get started”</a> vignette first!</p>
</div>
<p>This vignette shows how to model an epidemic in which stochasticity is expected to play an important role.
This is often the case with outbreaks of infections such as ebolavirus disease (EVD, or simply, ebola).</p>
<p><em>epidemics</em> includes a discrete time, stochastic compartmental model of ebola based on a consensus model presented in <span class="citation">Li et al. (<a href="#ref-li2019" role="doc-biblioref">2019</a>)</span>, with six compartments — susceptible, exposed, infectious, hospitalised, funeral, and removed.
The transitions between compartments are based on an Erlang model developed by <span class="citation">Getz and Dougherty (<a href="#ref-getz2018" role="doc-biblioref">2018</a>)</span> for the 2014 West African EVD outbreak, with the code adapted from <a href="http://epirecip.es/epicookbook/chapters/erlang/r" class="external-link">Epirecipes</a>.</p>
<p>The model does not include demographic variation in contacts, as ebola spreads primarily among contacts caring for infected individuals, making age or demographic structure less important.</p>
<p>This model can currently accommodate interventions on model rates only (as there are no demographic groups for contacts interventions).
The only rate in the model that can be influenced by an intervention is the transmission rate <span class="math inline">\(\beta\)</span>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># some initial setup to load necessary packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/epidemics" class="external-link">epidemics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</details><div class="section level2">
<h2 id="prepare-population-and-initial-conditions">Prepare population and initial conditions<a class="anchor" aria-label="anchor" href="#prepare-population-and-initial-conditions"></a>
</h2>
<p>Prepare population data — for this model, we only need the total population size and the initial conditions.</p>
<p>We can create a <code>&lt;population&gt;</code> object with dummy values for the contact matrix, and assign the total size to the demography vector.</p>
<p>We prepare a population with a total size of 14 million, corresponding to the population of Guinea, a West African country where the 2014 ebolavirus epidemic originated.</p>
<p>We assume that 1 person is initially infected and infectious, and 10 other people have been exposed and is yet to become infectious.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">population_size</span> <span class="op">&lt;-</span> <span class="fl">14e6</span></span>
<span></span>
<span><span class="co"># prepare initial conditions as proportions</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  S <span class="op">=</span> <span class="va">population_size</span> <span class="op">-</span> <span class="fl">11</span>, E <span class="op">=</span> <span class="fl">10</span>, I <span class="op">=</span> <span class="fl">1</span>, H <span class="op">=</span> <span class="fl">0</span>, F <span class="op">=</span> <span class="fl">0</span>, R <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span> <span class="op">/</span> <span class="va">population_size</span></span></code></pre></div>
</details><details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare a &lt;population&gt; object</span></span>
<span><span class="va">guinea_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Guinea"</span>,</span>
<span>  contact_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># note dummy value</span></span>
<span>  demography_vector <span class="op">=</span> <span class="fl">14e6</span>, <span class="co"># 14 million, no age groups</span></span>
<span>  initial_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    <span class="va">initial_conditions</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">guinea_population</span></span>
<span><span class="co">#&gt; &lt;population&gt;</span></span>
<span><span class="co">#&gt; Population name: "Guinea"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Demography:</span></span>
<span><span class="co">#&gt; Dem. grp. 1: 14,000,000 (100%)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contact matrix:</span></span>
<span><span class="co">#&gt;              Dem. grp. 1:</span></span>
<span><span class="co">#&gt; Dem. grp. 1:            1</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="prepare-pathogen-parameters">Prepare pathogen parameters<a class="anchor" aria-label="anchor" href="#prepare-pathogen-parameters"></a>
</h2>
<p>We prepare an <code>&lt;infection&gt;</code> class object for ebola, with an <span class="math inline">\(R_0\)</span> taken from the value estimated for ebola in Guinea <span class="citation">(<a href="#ref-althaus2014" role="doc-biblioref">Althaus 2014</a>)</span>.</p>
<p>We assume that ebola has a mean infectious period of 12 days, and that the time between exposure and symptom onset — the pre-infectious period — is 5 days.</p>
<p>This model does not yet have an explicit “deaths” compartment, but rather, the “removed” compartment holds all individuals who have recovered and who have died and been buried safely (see <strong>Details</strong>).
Functionally, they are similar as they are not part of the model dynamics.</p>
<p>We assume that only 10% of infectious individuals are hospitalised, and that hospitalisation achieves a modest 30% reduction in transmission between hospitalised individuals and those still susceptible.
We assume also that any deaths in hospital lead to ebola-safe funerals, such that no further infections result from them.</p>
<p>We assume that infectious individuals who are not hospitalised die in the community, and that their funerals are potentially not ebola-safe.
We assume that the transmission rate of ebola at funerals is 50% of the baseline transmission rate.
This can also be interpreted as the proportion of funerals that are ebola-safe.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare ebola parameters as an infection class object</span></span>
<span><span class="va">ebola</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/infection.html">infection</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"ebolavirus disease"</span>,</span>
<span>  r0 <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  infectious_period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  preinfectious_period <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  prop_hospitalised <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  etu_safety <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  funeral_safety <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print to visualise</span></span>
<span><span class="va">ebola</span></span>
<span><span class="co">#&gt; &lt;infection&gt;</span></span>
<span><span class="co">#&gt; infection name: "ebolavirus disease"</span></span>
<span><span class="co">#&gt; R0: 1.5</span></span>
<span><span class="co">#&gt; Infectious period: 12</span></span>
<span><span class="co">#&gt; Other infection parameters:</span></span>
<span><span class="co">#&gt; "preinfectious_period", "prop_hospitalised", "etu_safety", "funeral_safety"</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="run-epidemic-model">Run epidemic model<a class="anchor" aria-label="anchor" href="#run-epidemic-model"></a>
</h2>
<p>We run the model using the function <code><a href="../reference/epidemic_ebola.html">epidemic_ebola_r()</a></code>.
While there is a C++ equivalent of this model, it was not found to be much faster than the R-only version, and is not made available to users.</p>
<p>The model is run for 100 days, with data reported on each day.
This is an appropriate period over which to obtain initial predictions for the outbreak, and after which response efforts such as non-pharmaceutical interventions and vaccination campaigns are likely to be launched to bring the outbreak under control.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set seed to get consistent results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run the epidemic model using `epidemic`</span></span>
<span><span class="co"># we call the model "ebola" from the library</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidemic_ebola.html">epidemic_ebola_r</a></span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">guinea_population</span>,</span>
<span>  infection <span class="op">=</span> <span class="va">ebola</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view the head of the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;    time demography_group  compartment    value</span></span>
<span><span class="co">#&gt; 1:    1     demo_group_1  susceptible 13999989</span></span>
<span><span class="co">#&gt; 2:    1     demo_group_1      exposed       10</span></span>
<span><span class="co">#&gt; 3:    1     demo_group_1   infectious        1</span></span>
<span><span class="co">#&gt; 4:    1     demo_group_1 hospitalised        0</span></span>
<span><span class="co">#&gt; 5:    1     demo_group_1      funeral        0</span></span>
<span><span class="co">#&gt; 6:    1     demo_group_1      removed        0</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="prepare-data-and-visualise-infections">Prepare data and visualise infections<a class="anchor" aria-label="anchor" href="#prepare-data-and-visualise-infections"></a>
</h2>
<p>We plot the ebola epidemic over time, showing the number of individuals exposed and infectious.</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot figure of epidemic curve</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span><span class="op">[</span><span class="va">compartment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exposed"</span>, <span class="st">"infectious"</span><span class="op">)</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span>,</span>
<span>    colour <span class="op">=</span> <span class="va">compartment</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>    name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Exposed"</span>, <span class="st">"Infectious"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">101</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"Compartment"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="ebola_model_files/figure-html/unnamed-chunk-6-1.png" alt="Model results from a single run showing the number of individuals in the exposed and infectious compartments over 100 days of the outbreak. The model assumes that 1 initially infectious person has exposed 10 others."><p class="caption">
Figure 1: Model results from a single run showing the number of individuals in the exposed and infectious compartments over 100 days of the outbreak. The model assumes that 1 initially infectious person has exposed 10 others.
</p>
</div>
</div>
<div class="section level2">
<h2 id="consensus-estimates-from-multiple-model-iterations">Consensus estimates from multiple model iterations<a class="anchor" aria-label="anchor" href="#consensus-estimates-from-multiple-model-iterations"></a>
</h2>
<p>Since the ebola model is a stochastic one, model results will vary in each run.
We can run the model multiple times — here, 100 times — and plot the number of infectious people, to get a consensus idea of what an ebola outbreak might look like.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set seed for consistent output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run the simulation 100 times</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>  f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidemic_ebola.html">epidemic_ebola_r</a></span><span class="op">(</span></span>
<span>      population <span class="op">=</span> <span class="va">guinea_population</span>,</span>
<span>      infection <span class="op">=</span> <span class="va">ebola</span>,</span>
<span>      time_end <span class="op">=</span> <span class="fl">100</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># add replicate number and return data</span></span>
<span>    <span class="va">data</span><span class="op">$</span><span class="va">replicate</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>    <span class="va">data</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use data.table to collect the data</span></span>
<span><span class="va">data_timeseries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
</details><p>We plot the data.</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_timeseries</span><span class="op">[</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"infectious"</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span>, group <span class="op">=</span> <span class="va">replicate</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.3</span>, colour <span class="op">=</span> <span class="st">"grey50"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span><span class="op">)</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"ribbon"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"red"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span><span class="op">)</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"line"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">101</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals infectious with ebola"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="ebola_model_files/figure-html/unnamed-chunk-8-1.png" alt="Model results from 100 runs showing the number of individuals in the infectious compartments over 100 days of each outbreak. All models assume that 1 initially infectious person has exposed 10 others. A simple summary using the mean (black line with standard error as shaded red regions), plotted over the individual model runs (grey) show that there can be wide variation in individual outbreak trajectories."><p class="caption">
Figure 2: Model results from 100 runs showing the number of individuals in the infectious compartments over 100 days of each outbreak. All models assume that 1 initially infectious person has exposed 10 others. A simple summary using the mean (black line with standard error as shaded red regions), plotted over the individual model runs (grey) show that there can be wide variation in individual outbreak trajectories.
</p>
</div>
<p>We observe that model stochasticity leads to wide variation in model outcomes, and not all simulation replicates lead to exponential growth of the outbreak within the first 100 days.
However, in a number of replicates, the outbreak has only a low daily incidence within the simulation time, although these replicates might show exponential growth later.</p>
<p>We can find the ‘final size’ of each replicate using the <code><a href="../reference/epidemic_size.html">epidemic_size()</a></code> function on the original simulation data.
Note that the final size here refers to the final size after 365 days, which is the duration of our simulation.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># apply the function over each replicate</span></span>
<span><span class="va">data_final_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  f <span class="op">=</span> <span class="va">epidemic_size</span>, deaths <span class="op">=</span> <span class="cn">FALSE</span>, by_group <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">data_final_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">data_final_size</span><span class="op">)</span></span></code></pre></div>
</details><details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot a histogram of the replicates</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">data_final_size</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"steelblue"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Epidemic size at 100 days"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of replicates"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="ebola_model_files/figure-html/unnamed-chunk-10-1.png" alt="Histogram of the final outbreak sizes of 100 ebola outbreaks. These are taken from the 100 model runs presented in the earlier figure, and show that most outbreaks may affect fewer than 500 individuals within their first 100 days."><p class="caption">
Figure 3: Histogram of the final outbreak sizes of 100 ebola outbreaks. These are taken from the 100 model runs presented in the earlier figure, and show that most outbreaks may affect fewer than 500 individuals within their first 100 days.
</p>
</div>
<p>We see that while some replicates affect over 600 individuals within the first 100 days, most replicates have fewer than 500 cases, suggesting that responses to halt the spread of ebola could be quite effective in most real outbreaks.</p>
</div>
<div class="section level2">
<h2 id="applying-interventions-that-reduce-transmission">Applying interventions that reduce transmission<a class="anchor" aria-label="anchor" href="#applying-interventions-that-reduce-transmission"></a>
</h2>
<p>An intervention that reduces transmission can be applied by passing a <code>&lt;rate_intervention&gt;</code> on the transmission rate parameter, <code>beta</code>.</p>
<p>We model an intervention that begins 30 days into the outbreak, and reduces transmission by 20%. T</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create an intervention on the transmission rate</span></span>
<span><span class="va">reduce_transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intervention.html">intervention</a></span><span class="op">(</span></span>
<span>  type <span class="op">=</span> <span class="st">"rate"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fl">30</span>, time_end <span class="op">=</span> <span class="fl">100</span>, reduction <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><p>We can pass the intervention to the model function’s <code>intervention</code> argument.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set a seed for comparison with the baseline model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run the epidemic model and save data as the baseline</span></span>
<span><span class="va">data_baseline</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidemic_ebola.html">epidemic_ebola_r</a></span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">guinea_population</span>,</span>
<span>  infection <span class="op">=</span> <span class="va">ebola</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># note that the intervention is passed within a list,</span></span>
<span><span class="co"># where it is named for the rate it is targeting</span></span>
<span><span class="va">data_intervention</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidemic_ebola.html">epidemic_ebola_r</a></span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">guinea_population</span>,</span>
<span>  infection <span class="op">=</span> <span class="va">ebola</span>,</span>
<span>  intervention <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    beta <span class="op">=</span> <span class="va">reduce_transmission</span></span>
<span>  <span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assign scenario names</span></span>
<span><span class="va">data_baseline</span><span class="op">$</span><span class="va">scenario</span> <span class="op">&lt;-</span> <span class="st">"baseline"</span></span>
<span><span class="va">data_intervention</span><span class="op">$</span><span class="va">scenario</span> <span class="op">&lt;-</span> <span class="st">"intervention"</span></span>
<span></span>
<span><span class="co"># bind the data together</span></span>
<span><span class="va">data_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data_baseline</span>, <span class="va">data_intervention</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_scenarios</span><span class="op">[</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"infectious"</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dotted"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span>, colour <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Set1"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Scenario"</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="st">"Intervention"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Days"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of individuals infectious"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-13"></span>
<img src="ebola_model_files/figure-html/unnamed-chunk-13-1.png" alt="Effect of implementing an intervention that reduces transmission by 30% during an ebola outbreak. The intervention begins on the 30th day (dotted vertical line), and is active for the remainder of the model duration. Applying this intervention leads to many fewer individuals infectious with ebola over the outbreak."><p class="caption">
Figure 4: Effect of implementing an intervention that reduces transmission by 30% during an ebola outbreak. The intervention begins on the 30th day (dotted vertical line), and is active for the remainder of the model duration. Applying this intervention leads to many fewer individuals infectious with ebola over the outbreak.
</p>
</div>
<p>We see that applying an intervention that reduces transmission can be effective in reducing the number of individuals infected over the outbreak.
This model will soon be able to accommodate interventions that act on other processes, such as hospitalisation and funeral safety, to model the effect of campaigns to tackle these as sources of infections.</p>
</div>
<div class="section level2">
<h2 id="details-discrete-time-ebola-virus-disease-model">Details: Discrete-time ebola virus disease model<a class="anchor" aria-label="anchor" href="#details-discrete-time-ebola-virus-disease-model"></a>
</h2>
<p>This model has compartments adopted from a consensus model for Ebola virus disease presented in <span class="citation">(<a href="#ref-li2019" role="doc-biblioref">Li et al. 2019</a>)</span>, but some of the compartmental transitions allowed have been simplified (see sub-section on hospitalisation).</p>
<p>The model implementation differs from <span class="citation">Getz and Dougherty (<a href="#ref-getz2018" role="doc-biblioref">2018</a>)</span> in allowing users to set the basic reproductive number <span class="math inline">\(R_0\)</span>, and the mean infectious (<span class="math inline">\(\rho^I\)</span> in Getz and Dougherty) and pre-infectious periods in days (<span class="math inline">\(\rho^E\)</span> in Getz and Dougherty).
Getz and Dougherty instead calculate these from other model parameters.</p>
<p>The shape of the Erlang distributions of passage times through the exposed and infectious compartments (<span class="math inline">\(k^E\)</span> and <span class="math inline">\(k^I\)</span>) are fixed to 2 (this was allowed to vary in Getz and Dougherty).</p>
<p>The transition rates between the exposed and infectious, and infectious and funeral compartments, <span class="math inline">\(\gamma^E\)</span> and <span class="math inline">\(\gamma^I\)</span> in Getz and Dougherty’s notation, are calculated following their equation (6).</p>
<p><span class="math display">\[\gamma^E = \dfrac{k^E}{\rho^E} = \dfrac{2}{\rho^E} ~\text{and}~
\gamma^I = \dfrac{k^I}{\rho^I} = \dfrac{2}{\rho^I}\]</span></p>
<p>In this discrete time model, <span class="math inline">\(\gamma^E\)</span> and <span class="math inline">\(\gamma^I\)</span> are used to determine the number of Erlang sub-compartments in each epidemiological compartment, and the probability of newly exposed or infectious individuals beginning in one of the compartments (thus allowing for variation in passage times).</p>
<div class="section level3">
<h3 id="hospitalisation-funerals-and-removal">Hospitalisation, funerals, and removal<a class="anchor" aria-label="anchor" href="#hospitalisation-funerals-and-removal"></a>
</h3>
<p><span class="citation">Li et al. (<a href="#ref-li2019" role="doc-biblioref">2019</a>)</span> present a consensus model for EVD in which individuals can follow multiple pathways from the infectious compartment — to hospitalisation, funeral transmission, and safe burial or recovery (removed), with the possibility of skipping some compartments in this sequence (e.g. directly from infectious to removed, infectious to hospitalisation to removed etc.).
This model simplifies these transitions to only two pathways:</p>
<ol style="list-style-type: decimal">
<li><p>Infectious → funeral → removed (safe burial)</p></li>
<li><p>Infectious → hospitalised → removed (recovery or safe burial)</p></li>
</ol>
<p>Infectious individuals have a probability <span class="math inline">\(p_\text{hosp}\)</span> of being transferred to the hospitalised compartment.
Infectious individual with <span class="math inline">\(N\)</span> timesteps before exiting the infectious compartment will exit the hospitalised compartment in the same time.</p>
<p>Hospitalised individuals can contribute to transmission of Ebola to susceptibles depending on the value of <span class="math inline">\(p_\text{ETU}\)</span>, which is the probability (or proportion) of hospitalised cases contributing to the infection of susceptibles.
This is interpreted as the relative safety of Ebolavirus treatment units (ETUs), with a range of 0.0 – 1.0, where 0.0 indicates that hospitalisation does not reduce transmission at all, while 1.0 indicates that hospitalisation prevents onward transmission entirely.
This is passed as the <code>etu_safety</code> value of the <code>&lt;infection&gt;</code>-class object passed to the <code>infection</code> argument in <code><a href="../reference/epidemic_ebola.html">epidemic_ebola_r()</a></code>.</p>
<p>We assume that deaths in hospital lead to Ebola-safe funerals, and individuals exiting the hospitalised compartment move to the ‘removed’ compartment, which holds both recoveries and deaths.</p>
<p>We assume that infectious individuals who are not hospitalised die, and that deaths outside of hospital lead to funerals that are potentially not Ebola-safe, and the contribution of funerals to Ebola transmission is determined by <span class="math inline">\(p_\text{funeral}\)</span>, which can be interpreted as the probability of transmission at a funeral, or the proportion of funerals that are Ebola-safe.
The relative safety of funerals is passed as the <code>funeral_safety</code> value of the <code>infection</code> argument.</p>
<p>Individuals are assumed to spend only a single timestep in the funeral transmission compartment, before they move into the ‘removed’ compartment. Individuals in the ‘removed’ compartment do not affect model dynamics.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-althaus2014" class="csl-entry">
Althaus, Christian L. 2014. <span>“Estimating the Reproduction Number of Ebola Virus (EBOV) During the 2014 Outbreak in West Africa.”</span> <em>PLoS Currents</em> 6 (September): ecurrents.outbreaks.91afb5e0f279e7f29e7056095255b288. <a href="https://doi.org/10.1371/currents.outbreaks.91afb5e0f279e7f29e7056095255b288" class="external-link">https://doi.org/10.1371/currents.outbreaks.91afb5e0f279e7f29e7056095255b288</a>.
</div>
<div id="ref-getz2018" class="csl-entry">
Getz, Wayne M., and Eric R. Dougherty. 2018. <span>“Discrete Stochastic Analogs of Erlang Epidemic Models.”</span> <em>Journal of Biological Dynamics</em> 12 (1): 16–38. <a href="https://doi.org/10.1080/17513758.2017.1401677" class="external-link">https://doi.org/10.1080/17513758.2017.1401677</a>.
</div>
<div id="ref-li2019" class="csl-entry">
Li, Shou-Li, Matthew J. Ferrari, Ottar N. Bjørnstad, Michael C. Runge, Christopher J. Fonnesbeck, Michael J. Tildesley, David Pannell, and Katriona Shea. 2019. <span>“Concurrent Assessment of Epidemiological and Operational Uncertainties for Optimal Outbreak Control: Ebola as a Case Study.”</span> <em>Proceedings of the Royal Society B: Biological Sciences</em> 286 (1905): 20190774. <a href="https://doi.org/10.1098/rspb.2019.0774" class="external-link">https://doi.org/10.1098/rspb.2019.0774</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Pratik Gupte, Rosalind Eggo, Edwin Van Leeuwen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
