<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="epidemics">
<title>Modelling leaky vaccination and hospitalisation outcomes with Vacamole • epidemics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modelling leaky vaccination and hospitalisation outcomes with Vacamole">
<meta property="og:description" content="epidemics">
<meta property="og:image" content="https://epiverse.github.io/epidemics/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">epidemics</a>

    <small class="nav-text text-muted me-auto version-number" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/epidemics.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Modelling interventions</h6>
    <a class="dropdown-item" href="../articles/modelling_interventions.html">Getting started with modelling interventions targeting social contacts</a>
    <a class="dropdown-item" href="../articles/multiple_interventions.html">Modelling overlapping and sequential interventions targeting social contacts</a>
    <a class="dropdown-item" href="../articles/rate_interventions.html">Modelling other interventions that change transmission rates</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Modelling vaccination</h6>
    <a class="dropdown-item" href="../articles/modelling_vaccination.html">Modelling the effect of a vaccination campaign</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Modelling seasonality</h6>
    <a class="dropdown-item" href="../articles/time_dependence.html">Modelling time-dependence and seasonality in transmission dynamics</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Other modelling vignettes</h6>
    <a class="dropdown-item" href="../articles/parameter_uncertainty.html">Generating and modelling parameter uncertainty</a>
    <a class="dropdown-item" href="../articles/finalsize_comparison.html">Comparing simulation-based and direct analytical methods for epidemic size estimation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Guides to library models</h6>
    <a class="dropdown-item" href="../articles/vacamole.html">Modelling leaky vaccination and hospitalisation outcomes with Vacamole</a>
    <a class="dropdown-item" href="../articles/ebola_model.html">Modelling responses to a stochastic Ebola virus epidemic</a>
    <a class="dropdown-item" href="../articles/benchmarking.html">Benchmarking R and Rcpp implementations of epidemic models</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/epidemics/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Modelling leaky vaccination and hospitalisation outcomes with Vacamole</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/epidemics/blob/HEAD/vignettes/vacamole.Rmd" class="external-link"><code>vignettes/vacamole.Rmd</code></a></small>
      <div class="d-none name"><code>vacamole.Rmd</code></div>
    </div>

    
    
<div class="alert alert-warning">
<p><strong>New to <em>epidemics</em>?</strong> It may help to read the <a href="epidemics.html">“Get started”</a> and <a href="modelling_vaccination.html">“Modelling a vaccination campaign”</a> vignettes first!</p>
</div>
<p>Vacamole is a deterministic, compartmental epidemic model built by Kylie Ainslie and others at <a href="https://www.rivm.nl/" class="external-link">RIVM, the Dutch Public Health Institute</a> for the Covid-19 pandemic, with a focus on scenario modelling for hospitalisation and vaccination <span class="citation">(<a href="#ref-ainslie2022" role="doc-biblioref">Ainslie et al. 2022</a>)</span>.</p>
<p>Vacamole was implemented as an R package, and the <a href="https://github.com/kylieainslie/vacamole" class="external-link">source code can be found on GitHub</a>. Some versions have been used to generate scenarios for the ECDC Covid-19 Scenario Hub.</p>
<p>The original model has 8 conceptual compartments - four epidemiological compartments: susceptible, exposed, infectious, and recovered (S, E, I, R respectively), three hospitalisation compartments: hospitalised, in intensive care, and returning from intensive care to regular hospital care (H, ICU, ICU2H), and death - see the <a href="doi.org/10.2807/1560-7917.ES.2022.27.44.2101090">manuscript describing them here</a>. Only infected individuals can enter the hospitalisation or death compartments.</p>
<p>Individuals from the susceptible compartment may be vaccinated partially (<span class="math inline">\(V_1\)</span>) or fully (<span class="math inline">\(V_2\)</span>; assuming a two dose regimen), with each dose reducing their probability of being infected, and of being hospitalised or dying.</p>
<div class="section level2">
<h2 id="modifications-for-epidemics">Modifications for <em>epidemics</em><a class="anchor" aria-label="anchor" href="#modifications-for-epidemics"></a>
</h2>
<p>We have made some modifications to the ODE model of Vacamole in order to make it more general and thus potentially more applicable to a wider range of settings.</p>
<p>Specifically,</p>
<ol style="list-style-type: decimal">
<li><p>We have dropped the ICU and ICU2H compartment as this is potentially less relevant to a context in which intensive care capacity is low.</p></li>
<li><p>We have added transitions from the infectious (I) and hospitalised (H) compartments to death (D), as this may be a more general assumption when hospital capacity is low (relatively more I → D) or when treatments are poor (relatively more H → D).</p></li>
<li>
<p>We assume, in a first pass implementation that vaccination primarily reduces adverse outcomes, by modification to the transition rates (<span class="math inline">\(\beta_V,\eta_{V},\omega_V\)</span>):</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\beta_V\)</span>: The transmission rate <span class="math inline">\(\beta\)</span> for individuals in the fully vaccinated compartment <span class="math inline">\(V_2\)</span>;</p></li>
<li><p><span class="math inline">\(\eta_{V}\)</span>: The hospitalisation rate <span class="math inline">\(\eta\)</span> for fully vaccinated, infected individuals (<span class="math inline">\(I_V\)</span> → <span class="math inline">\(H_V\)</span>);</p></li>
<li><p><span class="math inline">\(\omega_V\)</span>: The mortality rate for all fully vaccinated individuals at any stage in or post infection (I, or H).</p></li>
</ol>
</li>
</ol>
<div class="alert alert-primary">
<p>The details of the ODE system for the version of Vacamole included in <em>epidemics</em> can be found at <a href="#vacamole-ode-system-for-epidemics">the end of this page.</a></p>
</div>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/epidemics" class="external-link">epidemics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://colorspace.R-Forge.R-project.org/" class="external-link">colorspace</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="prepare-population-and-initial-conditions">Prepare population and initial conditions<a class="anchor" aria-label="anchor" href="#prepare-population-and-initial-conditions"></a>
</h2>
<p>Prepare population and contact data.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load contact and population data from socialmixr::polymod</span></span>
<span><span class="va">polymod</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="va"><a href="https://epiforecasts.io/socialmixr/reference/polymod.html" class="external-link">polymod</a></span></span>
<span><span class="va">contact_data</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="fu"><a href="https://epiforecasts.io/socialmixr/reference/contact_matrix.html" class="external-link">contact_matrix</a></span><span class="op">(</span></span>
<span>  <span class="va">polymod</span>,</span>
<span>  countries <span class="op">=</span> <span class="st">"United Kingdom"</span>,</span>
<span>  age.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">65</span><span class="op">)</span>,</span>
<span>  symmetric <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare contact matrix</span></span>
<span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">contact_data</span><span class="op">$</span><span class="va">matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare the demography vector</span></span>
<span><span class="va">demography_vector</span> <span class="op">&lt;-</span> <span class="va">contact_data</span><span class="op">$</span><span class="va">demography</span><span class="op">$</span><span class="va">population</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">demography_vector</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span></code></pre></div>
</details><p>Prepare initial conditions for each age group. The Vacamole model has 11 compartments and therefore requires a matrix with 11 columns.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># initial conditions</span></span>
<span><span class="va">initial_i</span> <span class="op">&lt;-</span> <span class="fl">1e-6</span></span>
<span></span>
<span><span class="co"># // 0| 1| 2|3| 4|5| 6|7| 8|9|10</span></span>
<span><span class="co"># // S|V1|V2|E|EV|I|IV|H|HV|D|R</span></span>
<span></span>
<span><span class="co"># make initial conditions - order is important</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  S <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">initial_i</span>,</span>
<span>  V1 <span class="op">=</span> <span class="fl">0</span>, V2 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  E <span class="op">=</span> <span class="fl">0</span>, EV <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  I <span class="op">=</span> <span class="va">initial_i</span>, IV <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  H <span class="op">=</span> <span class="fl">0</span>, HV <span class="op">=</span> <span class="fl">0</span>, D <span class="op">=</span> <span class="fl">0</span>, R <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="va">initial_conditions</span>,</span>
<span>  <span class="va">initial_conditions</span>,</span>
<span>  <span class="va">initial_conditions</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assign rownames for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">initial_conditions</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span></code></pre></div>
</details><p>Prepare the time in days over which to model the epidemic, with the outbreak beginning at day zero.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epidemic_days</span> <span class="op">&lt;-</span> <span class="fl">300</span></span></code></pre></div>
</details><p>Prepare a population as a <code>population</code> class object.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uk_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"UK"</span>,</span>
<span>  contact_matrix <span class="op">=</span> <span class="va">contact_matrix</span>,</span>
<span>  demography_vector <span class="op">=</span> <span class="va">demography_vector</span>,</span>
<span>  initial_conditions <span class="op">=</span> <span class="va">initial_conditions</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="prepare-a-two-dose-vaccination-campaign">Prepare a two dose vaccination campaign<a class="anchor" aria-label="anchor" href="#prepare-a-two-dose-vaccination-campaign"></a>
</h2>
<p>We prepare a two-dose vaccination campaign by concatenating two single dose vaccination regimes, i.e., applying the function <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> to two <code>vaccination</code> objects.</p>
<div class="alert alert-primary">
<p>It is possible to combine multiple vaccination objects together using <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> — the only limitation is that all vaccination regimes combined in this way must have the same number of demographic groups. It is possible to add a single dose to a two-vaccination regime by using <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> on two <code>vaccination</code> objects with two and one dose, respectively.</p>
</div>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare a two dose vaccination regime for a single age group</span></span>
<span><span class="co"># prepare the first dose</span></span>
<span><span class="va">dose_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vaccination.html">vaccination</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"two-dose vaccination"</span>, <span class="co"># name given to first dose</span></span>
<span>  nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1e-2</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">30</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">epidemic_days</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare the second dose with a 30 day interval in start date</span></span>
<span><span class="va">dose_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vaccination.html">vaccination</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"two-dose vaccination"</span>, <span class="co"># name given to first dose</span></span>
<span>  nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1e-2</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">60</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">epidemic_days</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use `c()` to combine the two doses</span></span>
<span><span class="va">double_vaccination</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dose_1</span>, <span class="va">dose_2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print to visualise</span></span>
<span><span class="va">double_vaccination</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  <span style="color: #BBBB00;">Vaccination name: </span></span></span>
<span><span class="co">#&gt;  <span style="color: #BBBB00;">Begins at:</span> </span></span>
<span><span class="co">#&gt;      dose_1 dose_2</span></span>
<span><span class="co">#&gt; [1,]     30     60</span></span>
<span><span class="co">#&gt; [2,]     30     60</span></span>
<span><span class="co">#&gt; [3,]     30     60</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  <span style="color: #BBBB00;">Ends at:</span> </span></span>
<span><span class="co">#&gt;      dose_1 dose_2</span></span>
<span><span class="co">#&gt; [1,]    300    300</span></span>
<span><span class="co">#&gt; [2,]    300    300</span></span>
<span><span class="co">#&gt; [3,]    300    300</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  <span style="color: #BBBB00;">Vaccination rate:</span> </span></span>
<span><span class="co">#&gt;      dose_1 dose_2</span></span>
<span><span class="co">#&gt; [1,]   0.01   0.01</span></span>
<span><span class="co">#&gt; [2,]   0.01   0.01</span></span>
<span><span class="co">#&gt; [3,]   0.01   0.01</span></span></code></pre></div>
</details><p>We prepare a dummy vaccination regime of no vaccination against which to compare the two-dose vaccination campaign. This is done by using the <code><a href="../reference/vaccination.html">no_vaccination()</a></code> function and specifying the number of doses (here, 2 doses).</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare a null vaccination regime with two doses</span></span>
<span><span class="co"># use the convenience function `no_vaccination()`</span></span>
<span><span class="va">no_vaccination</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vaccination.html">no_vaccination</a></span><span class="op">(</span>population <span class="op">=</span> <span class="va">uk_population</span>, doses <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="model-epidemic-using-vacamole">Model epidemic using Vacamole<a class="anchor" aria-label="anchor" href="#model-epidemic-using-vacamole"></a>
</h2>
<p>First, we run the model with no vaccination. The model’s default parameters are:</p>
<ul>
<li><p>Transmissibility (<span class="math inline">\(\beta\)</span>, <code>transmissibility</code>): 0.186, resulting from an <span class="math inline">\(R_0\)</span> = 1.3 and an infectious period of 7 days, given that <span class="math inline">\(\beta = R_0 / \text{infectious period}\)</span>.</p></li>
<li><p>Infectiousness rate (<span class="math inline">\(\sigma\)</span>, <code>infectiousness_rate</code>): 0.5, assuming a pre-infectious period of 2 days, given that <span class="math inline">\(\sigma = 1 / \text{pre-infectious period}\)</span>.</p></li>
<li><p>Hospitalisation rate (<span class="math inline">\(\eta\)</span>, <code>hospitalistion_rate</code>): 1.0 / 1000, assuming that one in every thousand infectious individuals is hospitalised.</p></li>
<li><p>Mortality rate (<span class="math inline">\(\omega\)</span>, <code>mortality_rate</code>): 1.0 / 1000, assuming that one in every thousand infectious and hospitalised individuals dies.</p></li>
<li><p>Recovery rate (<span class="math inline">\(\gamma\)</span>, <code>recovery_rate</code>): 0.143, assuming an infectious period of 7 days, given <span class="math inline">\(\gamma = 1 / \text{infectious period}\)</span>.</p></li>
<li><p>Susceptibility reduction from vaccination (<code>susc_reduction_vax</code>): 0.2, assuming a 20% reduction in susceptibility for individuals who are doubly vaccinated.</p></li>
<li><p>Hospitalisation reduction from vaccination (<code>hosp_reduction_vax</code>): 0.2, assuming a 20% reduction in hospitalisation for individuals who are doubly vaccinated.</p></li>
<li><p>Mortality reduction from vaccination (<code>mort_reduction_vax</code>): 0.2, assuming a 20% reduction in mortality for individuals who are doubly vaccinated.</p></li>
</ul>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_vacamole.html">model_vacamole_cpp</a></span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  vaccination <span class="op">=</span> <span class="va">no_vaccination</span>, <span class="co"># note custom no_vaccination object</span></span>
<span>  time_end <span class="op">=</span> <span class="va">epidemic_days</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><p>Next we run the model with a two dose vaccination regime.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_vaccination</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_vacamole.html">model_vacamole_cpp</a></span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  vaccination <span class="op">=</span> <span class="va">double_vaccination</span>, <span class="co"># note custom object for two doses</span></span>
<span>  time_end <span class="op">=</span> <span class="va">epidemic_days</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="visualise-model-outcomes">Visualise model outcomes<a class="anchor" aria-label="anchor" href="#visualise-model-outcomes"></a>
</h2>
<p>First, we calculate the total number of infections resulting in recoveries and deaths over the course of the simulation; this is the epidemic’s final size.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># collect data from the two scenarios</span></span>
<span><span class="va">data_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">data_vaccination</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get deaths and recoveries from infection</span></span>
<span><span class="va">data_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span></span>
<span>  <span class="va">data_scenarios</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no_vax"</span>, <span class="st">"vax"</span><span class="op">)</span>,</span>
<span>  f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">sc</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">demography_group</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># get total deaths per group</span></span>
<span>    <span class="va">df_</span><span class="op">$</span><span class="va">total_deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>      <span class="va">df</span>, <span class="va">time</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, <span class="va">compartment</span> <span class="op">==</span> <span class="st">"dead"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># get total recoveries per group using helper function `epidemic_size()`</span></span>
<span>    <span class="co"># do not count dead</span></span>
<span>    <span class="va">df_</span><span class="op">$</span><span class="va">total_recovered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidemic_size.html">epidemic_size</a></span><span class="op">(</span><span class="va">df</span>, include_deaths <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># add scenario information</span></span>
<span>    <span class="va">df_</span><span class="op">$</span><span class="va">scenario</span> <span class="op">&lt;-</span> <span class="va">sc</span></span>
<span></span>
<span>    <span class="co"># return data</span></span>
<span>    <span class="va">df_</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># collect data</span></span>
<span><span class="va">data_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">data_scenarios</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># transform to long format</span></span>
<span><span class="va">data_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>  <span class="va">data_scenarios</span>,</span>
<span>  cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"total_deaths"</span>, <span class="st">"total_recovered"</span><span class="op">)</span>,</span>
<span>  names_to <span class="op">=</span> <span class="st">"measure"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_scenarios</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">demography_group</span>, <span class="va">value</span>, fill <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="st">"dodge"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span></span>
<span>    facets <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">measure</span><span class="op">)</span>,</span>
<span>    scales <span class="op">=</span> <span class="st">"free_y"</span>,</span>
<span>    labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span></span>
<span>      measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        total_deaths <span class="op">=</span> <span class="st">"Total deaths"</span>,</span>
<span>        total_recovered <span class="op">=</span> <span class="st">"Epidemic size (infections without deaths)"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/scale_colour_discrete_qualitative.html" class="external-link">scale_fill_discrete_qualitative</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dynamic"</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No vaccination"</span>, <span class="st">"Vaccination"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Scenario"</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"lightgrey"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span></span>
<span>      scale <span class="op">=</span> <span class="fl">1e-6</span>, suffix <span class="op">=</span> <span class="st">"M"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span></span>
<span>      face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">11</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_scenarios</span><span class="op">$</span><span class="va">demography_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Age group"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"No. of individuals"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Effect of vaccination on deaths and total infections"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><p><img src="vacamole_files/figure-html/unnamed-chunk-11-1.png"><!-- --></p>
<p>Finally, we can compare the peak of hospital bed occupancy in each scenario — this can be a rough indication of how much hospital capacity would be required if a pandemic of these characteristics were to occur, as well as another way to examine the effect of vaccination in reducing this requirement.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># collect data from the two scenarios</span></span>
<span><span class="va">data_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">data_vaccination</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peak_hospital_occupancy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">data_scenarios</span>, <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># get highest hospital occupancy</span></span>
<span>  <span class="co"># first get total hospitalisations among vaccinated and un- or part-vacc.</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">df</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span></span>
<span>      pattern <span class="op">=</span> <span class="st">"hospitalised"</span>, x <span class="op">=</span> <span class="va">compartment</span>,</span>
<span>      fixed <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># summarise all hospitalised over time, aggregating away age groups</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>      total_hosp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, .by <span class="op">=</span> <span class="st">"time"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># filter for the time point with highest hospital occupancy</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">total_hosp</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">total_hosp</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># get the value</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">total_hosp</span><span class="op">)</span></span>
<span><span class="op">}</span>, FUN.VALUE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set names for comprehensibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">peak_hospital_occupancy</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No vaccination"</span>, <span class="st">"Vaccination"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show peak hospital occupancy in a readable format</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">peak_hospital_occupancy</span>, big.mark <span class="op">=</span> <span class="st">","</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; No vaccination    Vaccination </span></span>
<span><span class="co">#&gt;        "1,813"        "    5"</span></span></code></pre></div>
</details><p>This example demonstrates that implementing vaccination can substantially reduce peak hospital occupancy (by about 100%) compared to a scenario in which no vaccines are deployed.</p>
</div>
<div class="section level2">
<h2 id="vacamole-ode-system-for-epidemics">Vacamole ODE system for {epidemics}<a class="anchor" aria-label="anchor" href="#vacamole-ode-system-for-epidemics"></a>
</h2>
<p>The Vacamole ODE system adapted for {epidemics} is:</p>
<p>Susceptibles who are not vaccinated, or only partially vaccinated (considered unprotected) can transition to exposed and vaccinated:</p>
<p><span class="math display">\[dS = -\beta S(I+I_V) - \nu_1 S\]</span></p>
<p>Two sequential vaccination compartments, with a lower conversion rate from two-dose vaccinated individuals (considered to be protected) to exposed:</p>
<p><span class="math display">\[dV_1 = \nu_1S - \beta V_1(I+I_V) - \nu_2V_1\]</span></p>
<p><span class="math display">\[dV_2 = \nu_2V_1 - \beta_VV_2(I+I_V)\]</span></p>
<p>Two parallel exposed compartments, with similar conversion to infectious:</p>
<p><span class="math display">\[dE = \beta (S+V_1)(I+I_V) - \sigma E\]</span></p>
<p><span class="math display">\[dE_V = \beta_VV_2(I+I_V) - \sigma E_V\]</span></p>
<p>Two parallel infectious compartments, with lower hospitalisation and mortality rate for vaccinated:</p>
<p><span class="math display">\[dI = \sigma E - \gamma I - \eta I - \omega I\]</span></p>
<p><span class="math display">\[dI_V = \sigma E_V - \gamma I_V - \eta_{V} I_V - \omega_V I_V\]</span></p>
<p>Two parallel hospitalisation compartments, with a lower mortality rate for vaccinated:</p>
<p><span class="math display">\[dH = \eta I - \gamma H - \eta_2 H - \omega H\]</span></p>
<p><span class="math display">\[dH_V = \eta_{V} I - \gamma H_V - \omega_V H_V\]</span></p>
<p>Single recovered compartment:</p>
<p><span class="math display">\[dR = \gamma(I + H + I_V + H_V)\]</span></p>
<p>Single mortality compartment:</p>
<p><span class="math display">\[dD = \omega(I + H) + \omega_V(I_V + H_V)\]</span></p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ainslie2022" class="csl-entry">
Ainslie, Kylie E. C., Jantien A. Backer, Pieter T. de Boer, Albert Jan van Hoek, Don Klinkenberg, Hester Korthals Altes, Ka Yin Leung, Hester de Melker, Fuminari Miura, and Jacco Wallinga. 2022. <span>“A Scenario Modelling Analysis to Anticipate the Impact of COVID-19 Vaccination in Adolescents and Children on Disease Outcomes in the Netherlands, Summer 2021.”</span> <em>Eurosurveillance</em> 27 (44): 2101090. <a href="https://doi.org/10.2807/1560-7917.ES.2022.27.44.2101090" class="external-link">https://doi.org/10.2807/1560-7917.ES.2022.27.44.2101090</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Pratik Gupte, Rosalind Eggo, Edwin Van Leeuwen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
